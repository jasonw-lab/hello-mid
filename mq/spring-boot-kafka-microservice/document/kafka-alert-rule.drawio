<mxfile host="Electron" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/29.0.3 Chrome/140.0.7339.249 Electron/38.7.0 Safari/537.36" version="29.0.3" pages="3">
  <diagram name="Kafka Streams Inconsistency Alert" id="tNVYZlWmBPTOooPYvzeB">
    <mxGraphModel dx="2104" dy="957" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="9PFVn__YfKvGvs5ZydHp-1" value="Order Service&#xa;emit OrderConfirmed" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf" vertex="1" parent="1">
          <mxGeometry x="-258" y="65" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="9PFVn__YfKvGvs5ZydHp-2" value="Payment Service&#xa;emit PaymentSucceeded" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf" vertex="1" parent="1">
          <mxGeometry x="-258" y="185" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="9PFVn__YfKvGvs5ZydHp-3" value="Kafka Topics&#xa;orders.events.v1&#xa;payments.events.v1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656" vertex="1" parent="1">
          <mxGeometry x="2" y="115" width="240" height="120" as="geometry" />
        </mxCell>
        <mxCell id="9PFVn__YfKvGvs5ZydHp-4" value="Inconsistency Detector&#xa;(Kafka Streams App)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366" vertex="1" parent="1">
          <mxGeometry x="302" y="85" width="280" height="140" as="geometry" />
        </mxCell>
        <mxCell id="9PFVn__YfKvGvs5ZydHp-5" value="StateStore (RocksDB)&#xa;orderId → state + deadline" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" vertex="1" parent="1">
          <mxGeometry x="302" y="255" width="280" height="100" as="geometry" />
        </mxCell>
        <mxCell id="9PFVn__YfKvGvs5ZydHp-6" value="Kafka Topic&#xa;alerts.order_payment_inconsistency" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656" vertex="1" parent="1">
          <mxGeometry x="302" y="405" width="280" height="100" as="geometry" />
        </mxCell>
        <mxCell id="9PFVn__YfKvGvs5ZydHp-7" value="Alert Notifier&#xa;(Slack / Teams)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450" vertex="1" parent="1">
          <mxGeometry x="302" y="635" width="280" height="80" as="geometry" />
        </mxCell>
        <mxCell id="9PFVn__YfKvGvs5ZydHp-14" value="Alert Process Service&#xa;(Consume + Persist + Route)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450" vertex="1" parent="1">
          <mxGeometry x="302" y="525" width="280" height="80" as="geometry" />
        </mxCell>
        <mxCell id="9PFVn__YfKvGvs5ZydHp-8" style="endArrow=block;html=1;" edge="1" parent="1" source="9PFVn__YfKvGvs5ZydHp-1" target="9PFVn__YfKvGvs5ZydHp-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9PFVn__YfKvGvs5ZydHp-9" style="endArrow=block;html=1;" edge="1" parent="1" source="9PFVn__YfKvGvs5ZydHp-2" target="9PFVn__YfKvGvs5ZydHp-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9PFVn__YfKvGvs5ZydHp-10" style="endArrow=block;html=1;" edge="1" parent="1" source="9PFVn__YfKvGvs5ZydHp-3" target="9PFVn__YfKvGvs5ZydHp-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9PFVn__YfKvGvs5ZydHp-11" style="endArrow=block;html=1;" edge="1" parent="1" source="9PFVn__YfKvGvs5ZydHp-4" target="9PFVn__YfKvGvs5ZydHp-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9PFVn__YfKvGvs5ZydHp-12" style="endArrow=block;html=1;" edge="1" parent="1" source="9PFVn__YfKvGvs5ZydHp-4" target="9PFVn__YfKvGvs5ZydHp-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9PFVn__YfKvGvs5ZydHp-13" style="endArrow=block;html=1;" edge="1" parent="1" source="9PFVn__YfKvGvs5ZydHp-6" target="9PFVn__YfKvGvs5ZydHp-14">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9PFVn__YfKvGvs5ZydHp-15" style="endArrow=block;html=1;" edge="1" parent="1" source="9PFVn__YfKvGvs5ZydHp-14" target="9PFVn__YfKvGvs5ZydHp-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="DKy10y3z-yIT6nRl2pUj" name="ページ2">
    <mxGraphModel dx="2104" dy="1357" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-1" value="Order Service&#xa;emit OrderConfirmed" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf" vertex="1" parent="1">
          <mxGeometry x="-177" y="-21" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-2" value="Payment Service&#xa;emit PaymentSucceeded" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf" vertex="1" parent="1">
          <mxGeometry x="-177" y="99" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-3" value="Kafka Topics&#xa;orders.events.v1&#xa;payments.events.v1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656" vertex="1" parent="1">
          <mxGeometry x="83" y="29" width="240" height="120" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-4" value="Inconsistency Detector&#xa;(Kafka Streams App)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366" vertex="1" parent="1">
          <mxGeometry x="383" y="-1" width="280" height="140" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-5" value="StateStore (RocksDB)&#xa;orderId → state + deadline" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" vertex="1" parent="1">
          <mxGeometry x="383" y="169" width="280" height="100" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-6" value="Kafka Topic&#xa;alerts.order_payment_inconsistency" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656" vertex="1" parent="1">
          <mxGeometry x="963" y="29" width="280" height="100" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-7" value="Alert Notifier&#xa;(Slack / Teams)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450" vertex="1" parent="1">
          <mxGeometry x="961" y="-157" width="280" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-20" value="Alert Process Service&#xa;(Consume + Persist + Route)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450" vertex="1" parent="1">
          <mxGeometry x="961" y="-57" width="280" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-8" value="Rule A (赤)&#xa;PaymentSucceeded →&#xa;OrderConfirmed が T_confirm 以内に来ない&#xa;→ AlertRaised" style="text;html=1;strokeColor=none;fillColor=none;fontColor=#ff0000;fontStyle=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="683" y="19" width="300" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-9" value="Rule B (赤)&#xa;OrderConfirmed →&#xa;PaymentSucceeded が T_pay 以内に来ない&#xa;→ AlertRaised" style="text;html=1;strokeColor=none;fillColor=none;fontColor=#ff0000;fontStyle=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="683" y="119" width="300" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-10" value="Rule C (赤・重大)&#xa;同一 orderId で&#xa;PaymentSucceeded が複数回&#xa;→ 二重決済疑い (P1)" style="text;html=1;strokeColor=none;fillColor=none;fontColor=#ff0000;fontStyle=1;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="683" y="219" width="300" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-11" style="endArrow=block;html=1;dashed=1;strokeColor=#ff0000;endFill=1;" edge="1" parent="1" source="TPA_lsgtrF6rNvGRy8TY-8" target="TPA_lsgtrF6rNvGRy8TY-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-12" style="endArrow=block;html=1;dashed=1;strokeColor=#ff0000;endFill=1;" edge="1" parent="1" source="TPA_lsgtrF6rNvGRy8TY-9" target="TPA_lsgtrF6rNvGRy8TY-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-13" style="endArrow=block;html=1;dashed=1;strokeColor=#ff0000;endFill=1;" edge="1" parent="1" source="TPA_lsgtrF6rNvGRy8TY-10" target="TPA_lsgtrF6rNvGRy8TY-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-14" style="endArrow=block;html=1;" edge="1" parent="1" source="TPA_lsgtrF6rNvGRy8TY-1" target="TPA_lsgtrF6rNvGRy8TY-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-15" style="endArrow=block;html=1;" edge="1" parent="1" source="TPA_lsgtrF6rNvGRy8TY-2" target="TPA_lsgtrF6rNvGRy8TY-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-16" style="endArrow=block;html=1;" edge="1" parent="1" source="TPA_lsgtrF6rNvGRy8TY-3" target="TPA_lsgtrF6rNvGRy8TY-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-17" style="endArrow=block;html=1;" edge="1" parent="1" source="TPA_lsgtrF6rNvGRy8TY-4" target="TPA_lsgtrF6rNvGRy8TY-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-18" style="endArrow=block;html=1;" edge="1" parent="1" source="TPA_lsgtrF6rNvGRy8TY-4" target="TPA_lsgtrF6rNvGRy8TY-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-19" style="endArrow=block;html=1;" edge="1" parent="1" source="TPA_lsgtrF6rNvGRy8TY-6" target="TPA_lsgtrF6rNvGRy8TY-20">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="TPA_lsgtrF6rNvGRy8TY-21" style="endArrow=block;html=1;" edge="1" parent="1" source="TPA_lsgtrF6rNvGRy8TY-20" target="TPA_lsgtrF6rNvGRy8TY-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="biO2nEgzrKNYwqr9E_yh" name="ページ3">
    <mxGraphModel dx="2936" dy="1753" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="cBfdUd4junJDnaiCbnr2-1" value="Kafka Alert Demo Sequence (Single Sheet) — Rule A / Rule B / Rule C" style="text;html=1;strokeColor=none;fillColor=none;fontSize=18;fontStyle=1;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="-151" y="-17" width="1580" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-2" value="Client&#xa;(curl / API)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf" parent="1" vertex="1">
          <mxGeometry x="-151" y="33" width="160" height="50" as="geometry" />
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-3" value="Order Simulator&#xa;(REST API)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366" parent="1" vertex="1">
          <mxGeometry x="49" y="33" width="190" height="50" as="geometry" />
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-4" value="Payment Simulator&#xa;(REST API)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366" parent="1" vertex="1">
          <mxGeometry x="269" y="33" width="210" height="50" as="geometry" />
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-5" value="Kafka&#xa;Topics" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656" parent="1" vertex="1">
          <mxGeometry x="519" y="33" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-6" value="Alert Streams&#xa;(Transformer + StateStore + Punctuator)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450" parent="1" vertex="1">
          <mxGeometry x="719" y="33" width="250" height="50" as="geometry" />
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-34" value="Alert Process&#xa;Service" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450" parent="1" vertex="1">
          <mxGeometry x="1070" y="33" width="250" height="50" as="geometry" />
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-36" value="MySQL&#xa;sys_pay_alert" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" vertex="1" parent="1">
          <mxGeometry x="1388" y="29" width="220" height="50" as="geometry" />
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-7" style="dashed=1;strokeColor=#999999" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-71" y="83" as="sourcePoint" />
            <mxPoint x="-71" y="1283" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-8" style="dashed=1;strokeColor=#999999" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="144" y="83" as="sourcePoint" />
            <mxPoint x="144" y="1283" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-9" style="dashed=1;strokeColor=#999999" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="374" y="83" as="sourcePoint" />
            <mxPoint x="374" y="1283" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-10" style="dashed=1;strokeColor=#999999" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="604" y="83" as="sourcePoint" />
            <mxPoint x="604" y="1283" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-11" style="dashed=1;strokeColor=#999999" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="844" y="83" as="sourcePoint" />
            <mxPoint x="844" y="1283" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-35" style="dashed=1;strokeColor=#999999" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1084" y="83" as="sourcePoint" />
            <mxPoint x="1088" y="1407" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-37" style="dashed=1;strokeColor=#999999" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1498" y="79" as="sourcePoint" />
            <mxPoint x="1500" y="1482" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-12" value="Rule A: PaymentSucceeded → OrderConfirmed が T_confirm 以内に来ない → Alert(P2)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#ff0000;fontColor=#ff0000;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="-151" y="103" width="1580" height="40" as="geometry" />
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-13" value="Rule B: OrderConfirmed → PaymentSucceeded が T_pay 以内に来ない → Alert(P2)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#ff0000;fontColor=#ff0000;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="-151" y="503" width="1486" height="40" as="geometry" />
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-14" value="Rule C: 同一 orderId で PaymentSucceeded が複数回 → 即 Alert(P1)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#ff0000;fontColor=#ff0000;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="-151" y="903" width="1580" height="40" as="geometry" />
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-15" value="POST /sim/payment/succeeded&#xa;(orderId=O-1)" style="endArrow=block;html=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-71" y="183" as="sourcePoint" />
            <mxPoint x="374" y="183" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-16" value="produce PaymentSucceeded&#xa;payments.events.v1" style="endArrow=block;html=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="374" y="233" as="sourcePoint" />
            <mxPoint x="604" y="233" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-17" value="consume + update state (Transformer)&#xa;set A deadline = now + T_confirm" style="endArrow=block;html=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="604" y="283" as="sourcePoint" />
            <mxPoint x="844" y="283" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-18" value="... wait T_confirm ..." style="endArrow=open;dashed=1;html=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="844" y="333" as="sourcePoint" />
            <mxPoint x="844" y="333" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-19" value="Punctuator tick&#xa;deadline exceeded&#xa;OrderConfirmed missing" style="endArrow=block;html=1;dashed=1;strokeColor=#ff0000;fontColor=#ff0000" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="844" y="383" as="sourcePoint" />
            <mxPoint x="844" y="383" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-20" value="produce AlertRaised (A,P2)&#xa;alerts.order_payment_inconsistency" style="endArrow=block;html=1;strokeColor=#ff0000;fontColor=#ff0000" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="844" y="433" as="sourcePoint" />
            <mxPoint x="604" y="433" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-38" value="consume AlertRaised&#xa;log orderId/alertId/rule/severity" style="endArrow=block;html=1;strokeColor=#ff0000;fontColor=#ff0000" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="604" y="463" as="sourcePoint" />
            <mxPoint x="1084" y="463" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-39" value="UPSERT sys_pay_alert" style="endArrow=block;html=1;strokeColor=#ff0000;fontColor=#ff0000" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1084" y="493" as="sourcePoint" />
            <mxPoint x="1495" y="493" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-21" value="POST /sim/order/confirmed&#xa;(orderId=O-2)" style="endArrow=block;html=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-71" y="583" as="sourcePoint" />
            <mxPoint x="144" y="583" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-22" value="produce OrderConfirmed&#xa;orders.events.v1" style="endArrow=block;html=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="144" y="633" as="sourcePoint" />
            <mxPoint x="604" y="633" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-23" value="consume + update state (Transformer)&#xa;set B deadline = now + T_pay" style="endArrow=block;html=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="604" y="683" as="sourcePoint" />
            <mxPoint x="844" y="683" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-24" value="... wait T_pay ..." style="endArrow=open;dashed=1;html=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="844" y="733" as="sourcePoint" />
            <mxPoint x="844" y="733" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-25" value="Punctuator tick&#xa;deadline exceeded&#xa;PaymentSucceeded missing" style="endArrow=block;html=1;dashed=1;strokeColor=#ff0000;fontColor=#ff0000" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="844" y="783" as="sourcePoint" />
            <mxPoint x="844" y="783" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-26" value="produce AlertRaised (B,P2)&#xa;alerts.order_payment_inconsistency" style="endArrow=block;html=1;strokeColor=#ff0000;fontColor=#ff0000" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="844" y="833" as="sourcePoint" />
            <mxPoint x="604" y="833" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-40" value="consume AlertRaised&#xa;log orderId/alertId/rule/severity" style="endArrow=block;html=1;strokeColor=#ff0000;fontColor=#ff0000" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="604" y="863" as="sourcePoint" />
            <mxPoint x="1084" y="863" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-41" value="UPSERT sys_pay_alert" style="endArrow=block;html=1;strokeColor=#ff0000;fontColor=#ff0000" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1084" y="893" as="sourcePoint" />
            <mxPoint x="1498" y="893" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-27" value="POST /sim/payment/succeeded&#xa;(orderId=O-3, paymentId=P-1)" style="endArrow=block;html=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-71" y="983" as="sourcePoint" />
            <mxPoint x="374" y="983" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-28" value="produce PaymentSucceeded #1&#xa;payments.events.v1" style="endArrow=block;html=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="374" y="1033" as="sourcePoint" />
            <mxPoint x="604" y="1033" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-29" value="consume + update state&#xa;paymentSuccessCount=1" style="endArrow=block;html=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="604" y="1083" as="sourcePoint" />
            <mxPoint x="844" y="1083" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-30" value="POST /sim/payment/succeeded&#xa;(orderId=O-3, paymentId=P-2)" style="endArrow=block;html=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-71" y="1143" as="sourcePoint" />
            <mxPoint x="374" y="1143" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-31" value="produce PaymentSucceeded #2" style="endArrow=block;html=1;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="374" y="1193" as="sourcePoint" />
            <mxPoint x="604" y="1193" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-32" value="consume + update state&#xa;count=2 → Rule C" style="endArrow=block;html=1;strokeColor=#ff0000;fontColor=#ff0000" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="604" y="1243" as="sourcePoint" />
            <mxPoint x="844" y="1243" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-33" value="produce AlertRaised (C,P1)&#xa;alerts.order_payment_inconsistency" style="endArrow=block;html=1;strokeColor=#ff0000;fontColor=#ff0000" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="844" y="1293" as="sourcePoint" />
            <mxPoint x="604" y="1293" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-42" value="consume AlertRaised&#xa;log orderId/alertId/rule/severity" style="endArrow=block;html=1;strokeColor=#ff0000;fontColor=#ff0000" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="604" y="1323" as="sourcePoint" />
            <mxPoint x="1084" y="1323" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="cBfdUd4junJDnaiCbnr2-43" value="UPSERT sys_pay_alert" style="endArrow=block;html=1;strokeColor=#ff0000;fontColor=#ff0000" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1084" y="1353" as="sourcePoint" />
            <mxPoint x="1494" y="1359" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
